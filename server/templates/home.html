<!DOCTYPE html>
<html>
    <head>
        <title>Go Chat</title>
        <style>
            #chatbox {
                height: 300px;
                width: 500px;
                border: 1px solid black;
                overflow: auto;
            }
            #message {
                width: 400px;
            }
        </style>
    </head>
    <body>
        <div id="login">
            <input
                id="username"
                type="text"
                placeholder="Enter username"
            />
            <select id="language">
                <option value="en">English</option>
                <option value="es">Spanish</option>
                <option value="pl">Polish</option>
                <option value="zh">Chinese</option>
                <option value="ko">Korean</option>
                <option value="ja">Japanese</option>
                <!-- Add more languages as needed -->
            </select>
            <input
                id="room"
                type="text"
                placeholder="Enter room name"
            />
            <button id="enter">Enter Chat</button>
        </div>
        <div
            id="chat"
            style="display: none"
        >
            <div id="chatbox"></div>
            <input
                id="message"
                type="text"
            />
            <button id="send">Send</button>
            <button id="showRooms">Show Rooms</button>
        </div>

        <script>
            document.getElementById("enter").onclick = function () {
                var username = document.getElementById("username").value;
                var language = document.getElementById("language").value;
                var room = document.getElementById("room").value;
                if (username && language && room) {
                    document.getElementById("login").style.display = "none";
                    document.getElementById("chat").style.display = "block";
                    startChat(username, language, room);
                }
            };

            document.getElementById("showRooms").onclick = function () {
                var ws = new WebSocket("ws://localhost:8080/ws/rooms");
            };

            function startChat(username, language, room) {
                var ws = new WebSocket("ws://localhost:8080/ws?room=" + room);

                ws.onopen = function () {
                    ws.send(
                        JSON.stringify({
                            username: username,
                            language: language,
                        })
                    );
                };

                ws.onmessage = function (event) {
                    var chatbox = document.getElementById("chatbox");
                    var data = JSON.parse(event.data);
                    console.log(event.data);
                    chatbox.innerHTML +=
                        data.username + ": " + data.message + "<br>";
                    chatbox.scrollTop = chatbox.scrollHeight;
                };

                function sendMessage() {
                    var message = document.getElementById("message").value;
                    ws.send(
                        JSON.stringify({
                            username: username,
                            language: language,
                            message: message,
                        })
                    );
                    document.getElementById("message").value = "";
                }

                document.getElementById("send").onclick = sendMessage;

                document
                    .getElementById("message")
                    .addEventListener("keydown", function (event) {
                        if (event.key === "Enter") {
                            event.preventDefault();
                            sendMessage();
                        }
                    });
            }
        </script>
    </body>
</html>
